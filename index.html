<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AcceMap | Tu ciudad sin barreras</title>
    <!-- La fuente que elegiste es ley en accesibilidad -->
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --am-primary: #2e0249;
            /* Violeta Oscuro */
            --am-secondary: #570a57;
            --am-accent: #00ff85;
            /* Verde Ne√≥n */
            --am-text: #f8fafc;
            --am-bg: #0f172a;
            --font-main: 'Atkinson Hyperlegible', sans-serif;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--am-bg);
            color: var(--am-text);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .card {
            background: var(--am-primary);
            width: 100%;
            max-width: 500px;
            margin: 20px;
            padding: 2.5rem;
            border-radius: 2rem;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            width: 80px;
            height: 80px;
            margin-bottom: 1.5rem;
            border-radius: 50%;
            border: 2px solid var(--am-accent);
        }

        h1 {
            font-size: 2rem;
            line-height: 1.1;
            margin-bottom: 1rem;
            color: #fff;
        }

        p {
            color: #cbd5e1;
            line-height: 1.5;
            margin-bottom: 2rem;
        }

        .step {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .step.active {
            display: block;
        }

        /* Botones de Micro-reporte */
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .btn-choice {
            background: var(--am-secondary);
            border: 2px solid transparent;
            color: white;
            padding: 1rem;
            border-radius: 1rem;
            cursor: pointer;
            font-weight: bold;
            transition: 0.2s;
            text-align: center;
        }

        .btn-choice:hover {
            border-color: var(--am-accent);
            transform: translateY(-2px);
        }

        /* Estilo para las preguntas de selecci√≥n */
        label {
            display: block;
            margin-bottom: 1rem;
            font-weight: bold;
            color: var(--am-accent);
        }

        select,
        input,
        textarea {
            width: 100%;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0.8rem;
            border: none;
            background: #1e293b;
            color: white;
            font-family: var(--font-main);
            font-size: 1rem;
        }

        .btn-next {
            background: var(--am-accent);
            color: var(--am-primary);
            border: none;
            width: 100%;
            padding: 1.2rem;
            border-radius: 1rem;
            font-weight: 800;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .progress {
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--am-accent);
            width: 25%;
            transition: 0.3s;
        }
    </style>
</head>

<body>

    <!-- ... (Mantener los estilos CSS anteriores, solo actualizar√© el cuerpo y el script) ... -->

    <div class="card" id="app-container">
        <div class="progress">
            <div class="progress-bar" id="progress"></div>
        </div>

        <form id="accemap-validator">
            <!-- PASO 1: HERO + CATARSIS (Para todos) -->
            <div class="step active" id="step1">
                <img src="logo.png" alt="Logo" class="logo">
                <h1>No dejes que la ciudad detenga a nadie.</h1>
                <p>¬øHas visto alguna barrera de accesibilidad en la ciudad √∫ltimamente? El√≠gela abajo para mapear la
                    falta de accesibilidad en tiempo real:</p>
                <div class="grid">
                    <div class="btn-choice" onclick="nextStep(1, 'Ascensor malo')">üö´ Ascensor malo</div>
                    <div class="btn-choice" onclick="nextStep(1, 'Rampa bloqueada')">‚ôø Rampa bloqueada</div>
                    <div class="btn-choice" onclick="nextStep(1, 'Ba√±o no apto')">üöª Ba√±o no apto</div>
                    <div class="btn-choice" onclick="nextStep(1, 'Falta de estacionamiento PcD')">üÖøÔ∏è Falta de
                        estacionamiento PcD</div>
                    <button type="button" class="btn-choice" onclick="nextStep(1, 'Vereda en mal estado')">üöú Vereda
                        rota</button>
                    <div class="btn-choice" onclick="nextStep(1, 'Otro')">üöß Otra barrera</div>
                </div>
                <input type="hidden" name="issue" id="issue-input">
            </div>

            <!-- PASO 2: VALIDACI√ìN (Ajustada para v√≠ctimas y aliados) -->
            <div class="step" id="step2">
                <label>En tu experiencia, ¬øqu√© tan dif√≠cil es encontrar informaci√≥n confiable sobre rampas o
                    ascensores?</label>
                <select name="difficulty" required>
                    <option value="" disabled selected>Selecciona una opci√≥n</option>
                    <option value="1">Es f√°cil, siempre hay datos</option>
                    <option value="3">Es frustrante, hay que adivinar</option>
                    <option value="5">Es una pesadilla, no hay informaci√≥n</option>
                </select>

                <label>¬øCrees que un mapa colaborativo ayudar√≠a a mejorar la movilidad en tu ciudad?</label>
                <select name="would_use" required>
                    <option value="si">¬°Absolutamente!</option>
                    <option value="talvez">Podr√≠a servir</option>
                    <option value="no">No lo creo necesario</option>
                </select>

                <button type="button" class="btn-next" onclick="nextStep(2)">Continuar</button>
            </div>

            <!-- PASO 3: CONVERSI√ìN -->
            <div class="step" id="step3">
                <label>¬øViste algo que te molest√≥ o quieres contarnos por qu√© te importa la accesibilidad?</label>
                <textarea name="vent" rows="3" placeholder="Tu historia ayuda a visibilizar el problema..."></textarea>

                <label>√önete a la red de validadores. D√©janos tu email para avisarte cuando lancemos:</label>
                <input type="email" name="email" placeholder="tu@email.com" required>

                <button type="submit" class="btn-next" id="submit-btn">Finalizar y Reportar</button>
            </div>
        </form>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxccL4YlqqqG0VXorTL8nAc4_WVkl9YADIm_gpB-AeO5vjDHgauFxgxfNYm1nw7AuUR/exec';
        const container = document.getElementById('app-container');
        const form = document.getElementById('accemap-validator');

        // 1. L√≥gica de LocalStorage: ¬øYa report√≥ antes?
        window.onload = () => {
            if (localStorage.getItem('accemap_user_reported')) {
                showThankYouMessage(true);
            }
        };

        function showThankYouMessage(isRepeat) {
            const message = isRepeat
                ? "¬°Hola de nuevo, guardi√°n! Ya tenemos tu reporte anterior."
                : "¬°Gracias por tu reporte!";

            container.innerHTML = `
            <div style="text-align:center">
                <h1 style="color:var(--am-accent)">${message}</h1>
                <p>Tu aporte ayuda a crear una ciudad sin barreras.</p>
                <button class="btn-next" onclick="resetForm()">Reportar otra barrera</button>
                <br><br>
                <img src="https://i.ibb.co/X7fFmGj/Logo-Acce-Map.png" width="80">
            </div>
        `;
        }

        function resetForm() {
            localStorage.removeItem('accemap_user_reported');
            location.reload();
        }

        // 2. Navegaci√≥n entre pasos
        let currentStep = 1;
        function nextStep(step, val) {
            if (val) document.getElementById('issue-input').value = val;
            document.getElementById('step' + step).classList.remove('active');
            currentStep++;
            document.getElementById('step' + currentStep).classList.add('active');
            document.getElementById('progress').style.width = (currentStep * 33) + '%';
        }

        // 3. Env√≠o de datos
        form.addEventListener('submit', e => {
            e.preventDefault();
            const btn = document.getElementById('submit-btn');
            btn.innerText = 'ENVIANDO...';
            btn.disabled = true;

            fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                .then(response => {
                    localStorage.setItem('accemap_user_reported', 'true');
                    showThankYouMessage(false);
                })
                .catch(error => {
                    alert('Error de conexi√≥n. Int√©ntalo de nuevo.');
                    btn.disabled = false;
                    btn.innerText = 'FINALIZAR Y REPORTAR';
                });
        });
    </script>
</body>

</html>